require "./spec_helper"

require "../src/chunk"

describe Nbt::Chunk do
  it "unpacks long arrays" do
    packed = [0x8888888888888888_u64, 0x8888888888888888_u64]

    unpacked = Nbt::Chunk.unpack_array(packed, 4)
    unpacked.should eq([
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
    ])
  end

  it "packs into long arrays" do
    unpacked = [
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
      0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8,
    ] of UInt32

    packed = Nbt::Chunk.pack_array(unpacked, 4)
    packed.should eq([0x8888888888888888_u64, 0x8888888888888888_u64])
  end
end
